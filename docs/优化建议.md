# nginx-app - 优化建议

> **最后更新**: 2025-12-01

## 性能优化

### Gzip 压缩

```nginx
gzip on;
gzip_comp_level 6;
gzip_types text/plain text/css application/json application/javascript text/xml application/xml;
```

### 静态资源缓存

```nginx
location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
  expires 30d;
  add_header Cache-Control "public, immutable";
}
```

### Connection 优化

```nginx
keepalive_timeout 65;
keepalive_requests 100;
```

---

## 安全加固

### SSL 配置

```nginx
ssl_protocols TLSv1.2 TLSv1.3;
ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256';
ssl_prefer_server_ciphers on;
```

### 安全头

```nginx
add_header X-Frame-Options "SAMEORIGIN";
add_header X-Content-Type-Options "nosniff";
add_header X-XSS-Protection "1; mode=block";
```

---

## 监控

### 访问日志

```nginx
access_log /var/log/nginx/access.log combined;
error_log /var/log/nginx/error.log warn;
```

### 日志轮转

```bash
# /etc/logrotate.d/nginx
/var/log/nginx/*.log {
    daily
    rotate 14
    compress
    delaycompress
    notifempty
    sharedscripts
}
```

---

## 负载均衡 (可选)

```nginx
upstream erp_core {
    server erp-core-1:3009;
    server erp-core-2:3009;
    keepalive 32;
}

location /api {
    proxy_pass http://erp_core;
}
```
